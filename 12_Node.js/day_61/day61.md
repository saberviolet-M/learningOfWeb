# day61

## express中间件

> 中间件(Middleware )，特指业务流程的中间处理环节
>
> 中间件，是express最大的特色，也是最重要的一个设计
>
> 很多第三方模块，都可以当做express的中间件，配合express，开发更简单
>
> 一个express应用，是由各种各样的中间件组合完成的
>
> 中间件，本质上就是一个函数

![流程图](./media/流程图.png)

### 中间件语法

- 中间件函数中有四个基本参数， err、req、res、next
  - 很多情况下，err都会省略
  - req就是请求相关的对象
  - res就是响应相关的对象
  - next：它是一个函数，某些时候，可以省略

### 中间件的特点

- 每个中间件函数，共享req对象、共享res对象
  - js代码中，所有的req对象是一个对象；所有的res是一个对象
- 不调用`next()`，则程序执行到当前中间件函数后，不再向后执行
  - 注意中间件的顺序，因为有可能因为顺序原因，你的中间件函数不会执行
  - 为了防止代码逻辑混乱，调用 next() 函数后不要再写额外的代码
- 客户端发送过来的请求，可能连续调用多个中间件进行处理
- 使用`app.use()`注册的中间件，GET和POST请求都可以触发